!function(){var l=tinymce.util.Tools.resolve("tinymce.PluginManager"),q=tinymce.util.Tools.resolve("tinymce.Env"),f=function(a){return a.getParam("pagebreak_separator","\x3c!-- pagebreak --\x3e")},j=function(a){return a.getParam("pagebreak_split_block",!1)},w=function(){return"mce-pagebreak"},b=function(){return'<img src="'+q.transparentSrc+'" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />'},p=function(i){var g=f(i),e=new RegExp(g.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"gi");i.on("BeforeSetContent",function(a){a.content=a.content.replace(e,b())}),i.on("PreInit",function(){i.serializer.addNodeFilter("img",function(s){for(var c,u,m=s.length;m--;){if((u=(c=s[m]).attr("class"))&&-1!==u.indexOf("mce-pagebreak")){var o=c.parent;if(i.schema.getBlockElements()[o.name]&&j(i)){o.type=3,o.value=g,o.raw=!0,c.remove();continue}c.type=3,c.value=g,c.raw=!0}}})})},d=b,k=w,v=function(a){a.addCommand("mcePageBreak",function(){a.settings.pagebreak_split_block?a.insertContent("<p>"+d()+"</p>"):a.insertContent(d())})},h=function(c){c.on("ResolveName",function(a){"IMG"===a.target.nodeName&&c.dom.hasClass(a.target,k())&&(a.name="pagebreak")})},x=function(a){a.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),a.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"})};l.add("pagebreak",function(a){v(a),x(a),p(a),h(a)})}();