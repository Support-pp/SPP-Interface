!function(){var g=tinymce.util.Tools.resolve("tinymce.PluginManager"),w=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),q=tinymce.util.Tools.resolve("tinymce.util.Tools"),f=function(a){return a.getParam("save_enablewhendirty",!0)},p=function(a){return !!a.getParam("save_onsavecallback")},j=function(a){return !!a.getParam("save_oncancelcallback")},b=function(c,a){c.notificationManager.open({text:c.translate(a),type:"error"})},k=function(c){var a;if(a=w.DOM.getParent(c.id,"form"),!f(c)||c.isDirty()){if(c.save(),p(c)){return c.execCallback("save_onsavecallback",c),void c.nodeChanged()}a?(c.setDirty(!1),a.onsubmit&&!a.onsubmit()||("function"==typeof a.submit?a.submit():b(c,"Error: Form submit field collision.")),c.nodeChanged()):b(c,"Error: No form element found.")}},h=function(c){var a=q.trim(c.startContent);j(c)?c.execCallback("save_oncancelcallback",c):(c.setContent(a),c.undoManager.clear(),c.nodeChanged())},m=function(a){a.addCommand("mceSave",function(){k(a)}),a.addCommand("mceCancel",function(){h(a)})},x=function(a){return function(d){var c=d.control;a.on("nodeChange dirty",function(){c.disabled(f(a)&&!a.isDirty())})}},v=function(a){a.addButton("save",{icon:"save",text:"Save",cmd:"mceSave",disabled:!0,onPostRender:x(a)}),a.addButton("cancel",{text:"Cancel",icon:!1,cmd:"mceCancel",disabled:!0,onPostRender:x(a)}),a.addShortcut("Meta+S","","mceSave")};g.add("save",function(a){v(a),m(a)})}();