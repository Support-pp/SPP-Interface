!function(){var aJ=tinymce.util.Tools.resolve("tinymce.PluginManager"),aQ=tinymce.util.Tools.resolve("tinymce.util.VK"),a1=function(a){return a.target_list},aP=function(a){return a.rel_list},aW=function(a){return a.link_class_list},aO=function(a){return"boolean"==typeof a.link_assume_external_targets&&a.link_assume_external_targets},a5=function(a){return"boolean"==typeof a.link_context_toolbar&&a.link_context_toolbar},aL=function(a){return a.link_list},aT=function(a){return"string"==typeof a.default_link_target},aE=function(a){return a.default_link_target},a4=a1,a6=function(a,b){a.settings.target_list=b},aG=function(a){return !1!==a1(a)},ag=aP,ay=function(a){return aP(a)!==undefined},an=aW,al=function(a){return aW(a)!==undefined},ai=function(a){return !1!==a.link_title},am=function(a){return"boolean"==typeof a.allow_unsafe_link_target&&a.allow_unsafe_link_target},aS=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),aI=tinymce.util.Tools.resolve("tinymce.Env"),a3=function(d){if(!aI.ie||10<aI.ie){var g=document.createElement("a");g.target="_blank",g.href=d,g.rel="noreferrer noopener";var j=document.createEvent("MouseEvents");j.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),f=g,b=j,document.body.appendChild(f),f.dispatchEvent(b),document.body.removeChild(f)}else{var h=window.open("","_blank");if(h){h.opener=null;var c=h.document;c.open(),c.write('<meta http-equiv="refresh" content="0; url='+aS.DOM.encode(d)+'">'),c.close()}}var f,b},aA=tinymce.util.Tools.resolve("tinymce.util.Tools"),aK=function(d,g){var j,h,c=["noopener"],f=d?d.split(/\s+/):[],b=function(a){return a.filter(function(e){return -1===aA.inArray(c,e)})};return(f=g?(j=b(j=f)).length?j.concat(c):c:b(f)).length?(h=f,aA.trim(h.sort().join(" "))):null},a0=function(a,b){return b=b||a.selection.getNode(),aR(b)?a.dom.select("a[href]",b)[0]:a.dom.getParent(b,"a[href]")},a2=function(a){return a&&"A"===a.nodeName&&a.href},aR=function(a){return a&&"FIGURE"===a.nodeName&&/\bimage\b/i.test(a.className)},aH=function(a,b){var d,c;(c=a.dom.select("img",b)[0])&&(d=a.dom.getParents(c,"a[href]",b)[0])&&(d.parentNode.insertBefore(c,d),a.dom.remove(d))},aY=function(b,c,f){var d,a;(a=b.dom.select("img",c)[0])&&(d=b.dom.create("a",f),a.parentNode.insertBefore(d,a),d.appendChild(a))},ao=function(a,b){return function(c){a.undoManager.transact(function(){var d=a.selection.getNode(),f=a0(a,d),g={href:c.href,target:c.target?c.target:null,rel:c.rel?c.rel:null,"class":c["class"]?c["class"]:null,title:c.title?c.title:null};ay(a.settings)||!1!==am(a.settings)||(g.rel=aK(g.rel,"_blank"===g.target)),c.href===b.href&&(b.attach(),b={}),f?(a.focus(),c.hasOwnProperty("text")&&("innerText" in f?f.innerText=c.text:f.textContent=c.text),a.dom.setAttribs(f,g),a.selection.select(f),a.undoManager.add()):aR(d)?aY(a,d,g):c.hasOwnProperty("text")?a.insertContent(a.dom.createHTML("a",g,a.dom.encode(c.text))):a.execCommand("mceInsertLink",!1,g)})}},ak=function(a){return function(){a.undoManager.transact(function(){var b=a.selection.getNode();aR(b)?aH(a,b):a.execCommand("unlink")})}},aX=a2,aF=function(a){return 0<aA.grep(a,a2).length},aw=function(a){return !(/</.test(a)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(a)||-1===a.indexOf("href=")))},ah=a0,ar=function(a,b){var c=b?b.innerText||b.textContent:a.getContent({format:"text"});return c.replace(/\uFEFF/g,"")},ap=aK,af=tinymce.util.Tools.resolve("tinymce.util.Delay"),ax=tinymce.util.Tools.resolve("tinymce.util.XHR"),az={},av=function(b,d,c){var a=function(e,f){return f=f||[],aA.each(e,function(g){var h={text:g.text||g.title};g.menu?h.menu=a(g.menu):(h.value=g.value,d&&d(h)),f.push(h)}),f};return a(b,c||[])},aM=function(b,a,d){var c=b.selection.getRng();af.setEditorTimeout(b,function(){b.windowManager.confirm(a,function(e){b.selection.setRng(c),d(e)})})},ae=function(J,p){var G,B,y,k,z,C,w,I,q,F,H,A={},j=J.selection,E=J.dom,D=function(a){var c=y.find("#text");(!c.value()||a.lastControl&&c.value()===a.lastControl.text())&&c.value(a.control.text()),y.find("#href").value(a.control.value())},b=function(){B||!k||A.text||this.parent().parent().find("#text")[0].value(this.value())};k=aw(j.getContent()),G=ah(J),A.text=B=ar(J.selection,G),A.href=G?E.getAttrib(G,"href"):"",G?A.target=E.getAttrib(G,"target"):aT(J.settings)&&(A.target=aE(J.settings)),(H=E.getAttrib(G,"rel"))&&(A.rel=H),(H=E.getAttrib(G,"class"))&&(A["class"]=H),(H=E.getAttrib(G,"title"))&&(A.title=H),k&&(z={name:"text",type:"textbox",size:40,label:"Text to display",onchange:function(){A.text=this.value()}}),p&&(C={type:"listbox",label:"Link list",values:av(p,function(a){a.value=J.convertURL(a.value||a.url,"href")},[{text:"None",value:""}]),onselect:D,value:J.convertURL(A.href,"href"),onPostRender:function(){C=this}}),aG(J.settings)&&(a4(J.settings)===undefined&&a6(J,[{text:"None",value:""},{text:"New window",value:"_blank"}]),I={name:"target",type:"listbox",label:"Target",values:av(a4(J.settings))}),ay(J.settings)&&(w={name:"rel",type:"listbox",label:"Rel",values:av(ag(J.settings),function(a){!1===am(J.settings)&&(a.value=ap(a.value,"_blank"===A.target))})}),al(J.settings)&&(q={name:"class",type:"listbox",label:"Class",values:av(an(J.settings),function(a){a.value&&(a.textStyle=function(){return J.formatter.getCssText({inline:"a",classes:[a.value]})})})}),ai(J.settings)&&(F={name:"title",type:"textbox",label:"Title",value:A.title}),y=J.windowManager.open({title:"Insert link",data:A,body:[{name:"href",type:"filepicker",filetype:"file",size:40,autofocus:!0,label:"Url",onchange:function(a){var c=a.meta||{};C&&C.value(J.convertURL(this.value(),"href")),aA.each(a.meta,function(d,f){var g=y.find("#"+f);"text"===f?0===B.length&&(g.value(d),A.text=d):g.value(d)}),c.attach&&(az={href:this.value(),attach:c.attach}),c.text||b.call(this)},onkeyup:b,onpaste:b,onbeforecall:function(a){a.meta=y.toJSON()}},z,F,function(c){var a=[];if(aA.each(J.dom.select("a:not([href])"),function(d){var f=d.name||d.id;f&&a.push({text:f,value:"#"+f,selected:-1!==c.indexOf("#"+f)})}),a.length){return a.unshift({text:"None",value:""}),{name:"anchor",type:"listbox",label:"Anchors",values:a,onselect:D}}}(A.href),C,w,I,q],onSubmit:function(c){var f=aO(J.settings),h=ao(J,az),g=ak(J),a=aA.extend({},A,c.data),d=a.href;d?(k&&a.text!==B||delete a.text,0<d.indexOf("@")&&-1===d.indexOf("//")&&-1===d.indexOf("mailto:")?aM(J,"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",function(e){e&&(a.href="mailto:"+d),h(a)}):!0===f&&!/^\w+:/i.test(d)||!1===f&&/^\s*www[\.|\d\.]/i.test(d)?aM(J,"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",function(e){e&&(a.href="http://"+d),h(a)}):h(a)):g()}})},aD=function(a){var b,d,c;d=ae,"string"==typeof(c=aL((b=a).settings))?ax.send({url:c,success:function(e){d(b,JSON.parse(e))}}):"function"==typeof c?c(function(e){d(b,e)}):d(b,c)},at=function(a,b){return a.dom.getParent(b,"a[href]")},aq=function(a){return at(a,a.selection.getStart())},aC=function(b,c){if(c){var f=(a=c).getAttribute("data-mce-href")||a.getAttribute("href");if(/^#/.test(f)){var d=b.$(f);d.length&&b.selection.scrollIntoView(d[0],!0)}else{a3(c.href)}}var a},aV=function(a){return function(){aD(a)}},au=function(a){return function(){aC(a,aq(a))}},ac=function(a){return function(c){var d,g,f,b;return !!(a5(a.settings)&&(!(b=a.plugins.contextmenu)||!b.isContextMenuVisible())&&aX(c)&&3===(f=(g=(d=a.selection).getRng()).startContainer).nodeType&&d.isCollapsed()&&0<g.startOffset&&g.startOffset<f.data.length)}},aj=function(a){a.on("click",function(b){var c=at(a,b.target);c&&aQ.metaKeyPressed(b)&&(b.preventDefault(),aC(a,c))}),a.on("keydown",function(b){var c,d=aq(a);d&&13===b.keyCode&&!0===(c=b).altKey&&!1===c.shiftKey&&!1===c.ctrlKey&&!1===c.metaKey&&(b.preventDefault(),aC(a,d))})},ad=function(a){return function(){var b=this;a.on("nodechange",function(c){b.active(!a.readonly&&!!ah(a,c.element))})}},ab=function(a){return function(){var c=this,b=function(d){aF(d.parents)?c.show():c.hide()};aF(a.dom.getParents(a.selection.getStart()))||c.hide(),a.on("nodechange",b),c.on("remove",function(){a.off("nodechange",b)})}},aa=function(a){a.addCommand("mceLink",aV(a))},aZ=function(a){a.addShortcut("Meta+K","",aV(a))},aN=function(a){a.addButton("link",{active:!1,icon:"link",tooltip:"Insert/edit link",onclick:aV(a),onpostrender:ad(a)}),a.addButton("unlink",{active:!1,icon:"unlink",tooltip:"Remove link",onclick:ak(a),onpostrender:ad(a)}),a.addContextToolbar&&a.addButton("openlink",{icon:"newtab",tooltip:"Open link",onclick:au(a)})},aU=function(a){a.addMenuItem("openlink",{text:"Open link",icon:"newtab",onclick:au(a),onPostRender:ab(a),prependToContext:!0}),a.addMenuItem("link",{icon:"link",text:"Link",shortcut:"Meta+K",onclick:aV(a),stateSelector:"a[href]",context:"insert",prependToContext:!0}),a.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onclick:ak(a),stateSelector:"a[href]"})},aB=function(a){a.addContextToolbar&&a.addContextToolbar(ac(a),"openlink | link unlink")};aJ.add("link",function(a){aN(a),aU(a),aB(a),aj(a),aa(a),aZ(a)})}();