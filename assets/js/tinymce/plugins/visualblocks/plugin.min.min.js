!function(){var g=function(c){var a=c,d=function(){return a};return{get:d,set:function(f){a=f},clone:function(){return g(d())}}},t=tinymce.util.Tools.resolve("tinymce.PluginManager"),p=function(c,a){c.fire("VisualBlocks",{state:a})},B=function(a){return a.getParam("visualblocks_default_state",!1)},x=function(a){return a.settings.visualblocks_content_css},k=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),A=tinymce.util.Tools.resolve("tinymce.util.Tools"),y=k.DOM.uniqueId(),b=function(c,a){var f=A.toArray(c.getElementsByTagName("link"));if(0===A.grep(f,function(i){return i.id===y}).length){var d=k.DOM.create("link",{id:y,rel:"stylesheet",href:a});c.getElementsByTagName("head")[0].appendChild(d)}},j=function(d,a,i){var f=d.dom,c=x(d);b(d.getDoc(),c||a+"/css/visualblocks.css"),f.toggleClass(d.getBody(),"mce-visualblocks"),i.set(!i.get()),p(d,i.get())},q=function(c,a,d){c.addCommand("mceVisualBlocks",function(){j(c,a,d)})},w=function(a,c,d){a.on("PreviewFormats AfterPreviewFormats",function(f){d.get()&&a.dom.toggleClass(a.getBody(),"mce-visualblocks","afterpreviewformats"===f.type)}),a.on("init",function(){B(a)&&j(a,c,d)}),a.on("remove",function(){a.dom.removeClass(a.getBody(),"mce-visualblocks")})},h=function(c,a){return function(f){var d=f.control;d.active(a.get()),c.on("VisualBlocks",function(i){d.active(i.state)})}},z=function(c,a){c.addButton("visualblocks",{active:!1,title:"Show blocks",cmd:"mceVisualBlocks",onPostRender:h(c,a)}),c.addMenuItem("visualblocks",{text:"Show blocks",cmd:"mceVisualBlocks",onPostRender:h(c,a),selectable:!0,context:"view",prependToContext:!0})};t.add("visualblocks",function(c,a){var d=g(!1);q(c,a,d),z(c,d),w(c,a,d)})}();