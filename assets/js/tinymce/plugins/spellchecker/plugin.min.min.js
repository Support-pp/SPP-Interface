!function(){var ad=function(b){var a=b,c=function(){return a};return{get:c,set:function(d){a=d},clone:function(){return ad(c())}}},K=tinymce.util.Tools.resolve("tinymce.PluginManager"),af=function(a){return !(!/(^|[ ,])tinymcespellchecker([, ]|$)/.test(a.settings.plugins)||!K.get("tinymcespellchecker")||("undefined"!=typeof window.console&&window.console.log&&window.console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option."),0))},Z=function(a){return a.getParam("spellchecker_languages","English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv")},X=function(b){var a=b.getParam("language","en");return b.getParam("spellchecker_language",a)},ac=function(a){return a.getParam("spellchecker_rpc_url")},ab=function(a){return a.getParam("spellchecker_callback")},M=function(b){var a=new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\xa7\xa9\xab\xae\xb1\xb6\xb7\xb8\xbb\xbc\xbd\xbe\xbf\xd7\xf7\xa4\u201d\u201c\u201e\xa0\u2002\u2003\u2009]+',"g");return b.getParam("spellchecker_wordchar_pattern",a)},aa=tinymce.util.Tools.resolve("tinymce.util.Tools"),W=tinymce.util.Tools.resolve("tinymce.util.URI"),U=tinymce.util.Tools.resolve("tinymce.util.XHR"),H=function(a){return a.fire("SpellcheckStart")},Q=function(a){return a.fire("SpellcheckEnd")};function G(a){return a&&1===a.nodeType&&"false"===a.contentEditable}var A,V=function(E,b){var m,k,B,w,y,v=[],N=b.dom;function I(c,a){if(!c[0]){throw new Error("findAndReplaceDOMText cannot handle zero-length matches")}return{start:c.index,end:c.index+c[0].length,text:c[0],data:a}}function p(f){var c=E.getElementsByTagName("*"),h=[];f="number"==typeof f?""+f:null;for(var d=0;d<c.length;d++){var g=c[d],a=g.getAttribute("data-mce-index");null!==a&&a.length&&-1!==g.className.indexOf("mce-spellchecker-word")&&(a!==f&&null!==f||h.push(g))}return h}function T(c){for(var a=v.length;a--;){if(v[a]===c){return a}}return -1}function S(c){for(var a=0,d=v.length;a<d&&!1!==c(v[a],a);a++){}return this}function P(d){var a,f,c=p(d?T(d):null);for(a=c.length;a--;){(f=c[a]).parentNode.insertBefore(f.firstChild,f),f.parentNode.removeChild(f)}return this}function D(c){var a=p(T(c)),d=b.dom.createRng();return d.setStartBefore(a[0]),d.setEndAfter(a[a.length-1]),d}return B=b.schema.getBlockElements(),w=b.schema.getWhiteSpaceElements(),y=b.schema.getShortEndedElements(),{text:k=function C(a){var c;if(3===a.nodeType){return a.data}if(w[a.nodeName]&&!B[a.nodeName]){return""}if(G(a)){return"\n"}if(c="",(B[a.nodeName]||y[a.nodeName])&&(c+="\n"),a=a.firstChild){for(;c+=C(a),a=a.nextSibling;){}}return c}(E),matches:v,each:S,filter:function(c){var a=[];return S(function(f,d){c(f,d)&&a.push(f)}),v=a,this},reset:function(){return v.splice(0,v.length),P(),this},matchFromElement:function(a){return v[a.getAttribute("data-mce-index")]},elementFromMatch:function(a){return p(T(a))[0]},find:function(c,a){if(k&&c.global){for(;m=c.exec(k);){v.push(I(m,a))}}return this},add:function(c,a,d){return v.push({start:c,end:c+a,text:k.substr(c,a),data:d}),this},wrap:function(a){return v.length&&function(ah,am,h){var f,g,ag,aj,ak,x=[],an=0,al=ah,ai=0;(am=am.slice(0)).sort(function(d,c){return d.start-c.start}),ak=am.shift();ah:for(;;){if((B[al.nodeName]||y[al.nodeName]||G(al))&&an++,3===al.nodeType&&(!g&&al.length+an>=ak.end?(g=al,aj=ak.end-an):f&&x.push(al),!f&&al.length+an>ak.start&&(f=al,ag=ak.start-an),an+=al.length),f&&g){if(al=h({startNode:f,startNodeIndex:ag,endNode:g,endNodeIndex:aj,innerNodes:x,match:ak.text,matchIndex:ai}),an-=g.length-aj,g=f=null,x=[],ai++,!(ak=am.shift())){break}}else{if(w[al.nodeName]&&!B[al.nodeName]||!al.firstChild){if(al.nextSibling){al=al.nextSibling;continue}}else{if(!G(al)){al=al.firstChild;continue}}}for(;;){if(al.nextSibling){al=al.nextSibling;break}if(al.parentNode===ah){break ah}al=al.parentNode}}}(E,v,function(d){function c(h,f){var l=v[f];l.stencil||(l.stencil=d(l));var g=l.stencil.cloneNode(!1);return g.setAttribute("data-mce-index",f),h&&g.appendChild(N.doc.createTextNode(h)),g}return function(ap){var av,ai,x,ah=ap.startNode,al=ap.endNode,ar=ap.matchIndex,at=N.doc;if(ah===al){var ak=ah;x=ak.parentNode,0<ap.startNodeIndex&&(av=at.createTextNode(ak.data.substring(0,ap.startNodeIndex)),x.insertBefore(av,ak));var aw=c(ap.match,ar);return x.insertBefore(aw,ak),ap.endNodeIndex<ak.length&&(ai=at.createTextNode(ak.data.substring(ap.endNodeIndex)),x.insertBefore(ai,ak)),ak.parentNode.removeChild(ak),aw}av=at.createTextNode(ah.data.substring(0,ap.startNodeIndex)),ai=at.createTextNode(al.data.substring(ap.endNodeIndex));for(var au=c(ah.data.substring(ap.startNodeIndex),ar),aq=[],ao=0,am=ap.innerNodes.length;ao<am;++ao){var an=ap.innerNodes[ao],aj=c(an.data,ar);an.parentNode.replaceChild(aj,an),aq.push(aj)}var ag=c(al.data.substring(0,ap.endNodeIndex),ar);return(x=ah.parentNode).insertBefore(av,ah),x.insertBefore(au,ah),x.removeChild(ah),(x=al.parentNode).insertBefore(ag,al),x.insertBefore(ai,al),x.removeChild(al),ag}}(a)),this},unwrap:P,replace:function(c,a){var d=D(c);return d.deleteContents(),0<a.length&&d.insertNode(b.dom.doc.createTextNode(a)),d},rangeFromMatch:D,indexOf:T}},n=function(b,a){if(!a.get()){var c=V(b.getBody(),b);a.set(c)}return a.get()},Y=function(k,w,f,b,d,h,m){var p,g,x,v=ab(k);(v||(p=k,g=w,x=f,function(s,c,y,l){var u={method:s,lang:x.get()},a="";u["addToDictionary"===s?"word":"text"]=c,aa.each(u,function(r,o){a&&(a+="&"),a+=o+"="+encodeURIComponent(r)}),U.send({url:new W(g).toAbsolute(ac(p)),type:"post",content_type:"application/x-www-form-urlencoded",data:a,success:function(r){if(r=JSON.parse(r)){r.error?l(r.error):y(r)}else{var o=p.translate("Server response wasn't proper JSON.");l(o)}},error:function(){var o=p.translate("The spelling service was not found: (")+ac(p)+p.translate(")");l(o)}})})).call(k.plugins.spellchecker,b,d,h,m)},q=function(b,a,c){b.dom.select("span.mce-spellchecker-word").length||i(b,a,c)},i=function(b,a,c){if(n(b,c).reset(),c.set(null),a.get()){return a.set(!1),Q(b),!0}},F=function(b){var a=b.getAttribute("data-mce-index");return"number"==typeof a?""+a:a},ae=function(f,h,m,g,k){var d,l;if("string"!=typeof k&&k.words?(l=!!k.dictionary,d=k.words):d=k,f.setProgressState(!1),function(c){for(var a in c){return !1}return !0}(d)){var b=f.translate("No misspellings found.");return f.notificationManager.open({text:b,type:"info"}),void h.set(!1)}g.set({suggestions:d,hasDictionarySupport:l}),n(f,m).find(M(f)).filter(function(a){return !!d[a.text]}).wrap(function(a){return f.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":a.text})}),h.set(!0),H(f)},e={spellcheck:function(b,d,g,c,f,a){i(b,g,c)||(b.setProgressState(!0),Y(b,d,a,"spellcheck",n(b,c).text,function(h){ae(b,g,c,f,h)},function(h){b.notificationManager.open({text:h,type:"error"}),b.setProgressState(!1),i(b,g,c)}),b.focus())},checkIfFinished:q,addToDictionary:function(b,f,k,d,g,a,h){b.setProgressState(!0),Y(b,f,g,"addToDictionary",a,function(){b.setProgressState(!1),b.dom.remove(h,!0),q(b,k,d)},function(c){b.notificationManager.open({text:c,type:"error"}),b.setProgressState(!1)})},ignoreWord:function(b,d,g,c,f,a){b.selection.collapse(),a?aa.each(b.dom.select("span.mce-spellchecker-word"),function(h){h.getAttribute("data-mce-word")===c&&b.dom.remove(h,!0)}):b.dom.remove(f,!0),q(b,d,g)},findSpansByIndex:function(d,b){var g,c=[];if((g=aa.toArray(d.getBody().getElementsByTagName("span"))).length){for(var f=0;f<g.length;f++){var a=F(g[f]);null!==a&&a.length&&a===b.toString()&&c.push(g[f])}}return c},getElmIndex:F,markErrors:ae},z=function(b,g,c,f,d,a){return{getTextMatcher:function(){return f.get()},getWordCharPattern:function(){return M(b)},markErrors:function(h){e.markErrors(b,g,f,c,h)},getLanguage:function(){return d.get()}}},J=function(d,b,g,c,f,a){d.addCommand("mceSpellCheck",function(){e.spellcheck(d,b,g,c,f,a)})},j=function(h,v,b,C,g,m){var x,y,k,D,B=(k=h,x=aa.map(Z(k).split(","),function(a){return{name:(a=a.split("="))[0],value:a[1]}}),y=[],aa.each(x,function(a){y.push({selectable:!0,text:a.name,data:a.value})}),y),w=function(){e.spellcheck(h,v,b,C,m,g)},p={tooltip:"Spellcheck",onclick:w,onPostRender:function(c){var a=c.control;h.on("SpellcheckStart SpellcheckEnd",function(){a.active(b.get())})}};1<B.length&&(p.type="splitbutton",p.menu=B,p.onshow=(D=g,function(c){var a=D.get();c.control.items().each(function(d){d.active(d.settings.data===a)})}),p.onselect=function(a){g.set(a.control.settings.data)}),h.addButton("spellchecker",p),h.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:w,selectable:!0,onPostRender:function(){var a=this;a.active(b.get()),h.on("SpellcheckStart SpellcheckEnd",function(){a.active(b.get())})}})},R=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),O=tinymce.util.Tools.resolve("tinymce.ui.Factory"),L=function(h,f,k,d,b,g){h.on("click",function(l){var a=l.target;if("mce-spellchecker-word"===a.className){l.preventDefault();var m=e.findSpansByIndex(h,e.getElmIndex(a));if(0<m.length){var c=h.dom.createRng();c.setStartBefore(m[0]),c.setEndAfter(m[m.length-1]),h.selection.setRng(c),function(P,C,w,p,v,y,E,I){var x=[],S=w.get().suggestions[E];aa.each(S,function(o){x.push({text:o,onclick:function(){P.insertContent(P.dom.encode(o)),P.dom.remove(I),e.checkIfFinished(P,p,v)}})}),x.push({text:"-"}),w.get().hasDictionarySupport&&x.push({text:"Add to Dictionary",onclick:function(){e.addToDictionary(P,C,p,v,y,E,I)}}),x.push.apply(x,[{text:"Ignore",onclick:function(){e.ignoreWord(P,p,v,E,I)}},{text:"Ignore all",onclick:function(){e.ignoreWord(P,p,v,E,I,!0)}}]),(A=O.create("menu",{items:x,context:"contextmenu",onautohide:function(o){-1!==o.target.className.indexOf("spellchecker")&&o.preventDefault()},onhide:function(){A.remove(),A=null}})).renderTo(document.body);var N=R.DOM.getPos(P.getContentAreaContainer()),D=P.dom.getPos(I[0]),B=P.dom.getRoot();"BODY"===B.nodeName?(D.x-=B.ownerDocument.documentElement.scrollLeft||B.scrollLeft,D.y-=B.ownerDocument.documentElement.scrollTop||B.scrollTop):(D.x-=B.scrollLeft,D.y-=B.scrollTop),N.x+=D.x,N.y+=D.y,A.moveTo(N.x,N.y+I[0].offsetHeight)}(h,f,k,d,b,g,a.getAttribute("data-mce-word"),m)}}})};K.add("spellchecker",function(d,b){if(!1===af(d)){var g=ad(!1),c=ad(X(d)),f=ad(null),a=ad(null);return j(d,b,g,f,c,a),L(d,b,a,g,f,c),J(d,b,g,f,a,c),z(d,g,a,f,c,b)}})}();