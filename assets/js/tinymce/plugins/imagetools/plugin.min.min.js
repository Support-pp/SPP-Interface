!function(){var aG=function(a){var b=a,c=function(){return b};return{get:c,set:function(d){b=d},clone:function(){return aG(c())}}},aE=tinymce.util.Tools.resolve("tinymce.PluginManager"),a9=tinymce.util.Tools.resolve("tinymce.util.Tools");function aM(a,b){return aT(document.createElement("canvas"),a,b)}function aL(a){return a.getContext("2d")}function aT(a,b,c){return a.width=b,a.height=c,a}var a4,aD,a1,aQ,aV={create:aM,clone:function(a){var b;return aL(b=aM(a.width,a.height)).drawImage(a,0,0),b},resize:aT,get2dContext:aL,get3dContext:function(a){var b=null;try{b=a.getContext("webgl")||a.getContext("experimental-webgl")}catch(c){}return b||(b=null),b}},aK={getWidth:function(a){return a.naturalWidth||a.width},getHeight:function(a){return a.naturalHeight||a.height}},aW=window.Promise?window.Promise:function(){var q=function(a){if("object"!=typeof this){throw new TypeError("Promises must be constructed via new")}if("function"!=typeof a){throw new TypeError("not a function")}this._state=null,this._value=null,this._deferreds=[],g(a,b(d,this),b(m,this))},j=q.immediateFn||"function"==typeof setImmediate&&setImmediate||function(a){setTimeout(a,1)};function b(a,c){return function(){a.apply(c,arguments)}}var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};function h(a){var c=this;null!==this._state?j(function(){var i=c._state?a.onFulfilled:a.onRejected;if(null!==i){var l;try{l=i(c._value)}catch(o){return void a.reject(o)}a.resolve(l)}else{(c._state?a.resolve:a.reject)(c._value)}}):this._deferreds.push(a)}function d(a){try{if(a===this){throw new TypeError("A promise cannot be resolved with itself.")}if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c){return void g(b(c,a),b(d,this),b(m,this))}}this._state=!0,this._value=a,p.call(this)}catch(i){m.call(this,i)}}function m(a){this._state=!1,this._value=a,p.call(this)}function p(){for(var a=0,c=this._deferreds.length;a<c;a++){h.call(this,this._deferreds[a])}this._deferreds=null}function k(a,i,l,c){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof i?i:null,this.resolve=l,this.reject=c}function g(a,i,s){var c=!1;try{a(function(e){c||(c=!0,i(e))},function(e){c||(c=!0,s(e))})}catch(l){if(c){return}c=!0,s(l)}}return q.prototype["catch"]=function(a){return this.then(null,a)},q.prototype.then=function(e,a){var c=this;return new q(function(i,l){h.call(c,new k(e,a,i,l))})},q.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&f(arguments[0])?arguments[0]:arguments);return new q(function(r,n){if(0===a.length){return r([])}var c=a.length;function e(s,i){try{if(i&&("object"==typeof i||"function"==typeof i)){var u=i.then;if("function"==typeof u){return void u.call(i,function(v){e(s,v)},n)}}a[s]=i,0==--c&&r(a)}catch(o){n(o)}}for(var l=0;l<a.length;l++){e(l,a[l])}})},q.resolve=function(a){return a&&"object"==typeof a&&a.constructor===q?a:new q(function(c){c(a)})},q.reject=function(a){return new q(function(c,i){i(a)})},q.race=function(a){return new q(function(c,l){for(var o=0,i=a.length;o<i;o++){a[o].then(c,l)}})},q}(),aF=function(a){return function(){return a}},aX=aF(!1),aZ=aF(!0),aO={noop:function(){for(var a=[],b=0;b<arguments.length;b++){a[b]=arguments[b]}},noarg:function(a){return function(){for(var b=[],c=0;c<arguments.length;c++){b[c]=arguments[c]}return a()}},compose:function(b,a){return function(){for(var c=[],d=0;d<arguments.length;d++){c[d]=arguments[d]}return b(a.apply(null,arguments))}},constant:aF,identity:function(a){return a},tripleEquals:function(a,b){return a===b},curry:function(d){for(var c=[],f=1;f<arguments.length;f++){c[f-1]=arguments[f]}for(var b=new Array(arguments.length-1),g=1;g<arguments.length;g++){b[g-1]=arguments[g]}return function(){for(var a=[],i=0;i<arguments.length;i++){a[i]=arguments[i]}for(var k=new Array(arguments.length),h=0;h<k.length;h++){k[h]=arguments[h]}var j=b.concat(k);return d.apply(null,j)}},not:function(a){return function(){for(var b=[],c=0;c<arguments.length;c++){b[c]=arguments[c]}return !a.apply(null,arguments)}},die:function(a){return function(){throw new Error(a)}},apply:function(a){return a()},call:function(a){a()},never:aX,always:aZ},aC=aO.never,ax=aO.always,a3=function(){return az},az=(aQ={fold:function(a,b){return a()},is:aC,isSome:aC,isNone:ax,getOr:a1=function(a){return a},getOrThunk:aD=function(a){return a()},getOrDie:function(a){throw new Error(a||"error: getOrDie called on none.")},or:a1,orThunk:aD,map:a3,ap:a3,each:function(){},bind:a3,flatten:a3,exists:aC,forall:ax,filter:a3,equals:a4=function(a){return a.isNone()},equals_:a4,toArray:function(){return[]},toString:aO.constant("none()")},Object.freeze&&Object.freeze(aQ),aQ),ay=function(f){var a=function(){return f},c=function(){return d},b=function(e){return e(f)},d={fold:function(g,h){return h(f)},is:function(e){return f===e},isSome:ax,isNone:aC,getOr:a,getOrThunk:a,getOrDie:a,or:c,orThunk:c,map:function(e){return ay(e(f))},ap:function(e){return e.fold(a3,function(g){return ay(g(f))})},each:function(e){e(f)},bind:b,flatten:a,exists:b,forall:b,filter:function(e){return e(f)?d:az},equals:function(e){return e.is(f)},equals_:function(g,h){return g.fold(aC,function(e){return h(f,e)})},toArray:function(){return[f]},toString:function(){return"some("+f+")"}};return d},bl={some:ay,none:a3,from:function(a){return null===a||a===undefined?az:ay(a)}},by="undefined"!=typeof window?window:Function("return this;")(),bh=function(a,c){for(var d=c!==undefined&&null!==c?c:by,b=0;b<a.length&&d!==undefined&&null!==d;++b){d=d[a[b]]}return d},aR=function(a,b){var c=a.split(".");return bh(c,b)},bF={getOrDie:function(a,b){var c=aR(a,b);if(c===undefined||null===c){throw a+" not available on this browser"}return c}};function bH(){return new (bF.getOrDie("FileReader"))}var aS={atob:function(a){return bF.getOrDie("atob")(a)},requestAnimationFrame:function(a){bF.getOrDie("requestAnimationFrame")(a)}};function bI(a){return new aW(function(d,g){var j=URL.createObjectURL(a),f=new Image,h=function(){f.removeEventListener("load",c),f.removeEventListener("error",b)};function c(){h(),d(f)}function b(){h(),g("Unable to load data of type "+a.type+": "+j)}f.addEventListener("load",c),f.addEventListener("error",b),f.src=j,f.complete&&c()})}function bg(a){return new aW(function(b,d){var c=new XMLHttpRequest;c.open("GET",a,!0),c.responseType="blob",c.onload=function(){200==this.status&&b(this.response)},c.onerror=function(){var f,g=this;d(0===this.status?((f=new Error("No access to download image")).code=18,f.name="SecurityError",f):new Error("Error "+g.status+" downloading image"))},c.send()})}function bs(k){var G=k.split(","),z=/data:([^;]+)/.exec(G[0]);if(!z){return bl.none()}for(var w,y,C,J=z[1],j=G[1],I=aS.atob(j),B=I.length,q=Math.ceil(B/1024),F=new Array(q),H=0;H<q;++H){for(var D=1024*H,x=Math.min(D+1024,B),E=new Array(x-D),A=D,b=0;A<x;++b,++A){E[b]=I[A].charCodeAt(0)}F[H]=(w=E,new (bF.getOrDie("Uint8Array"))(w))}return bl.some((y=F,C={type:J},new (bF.getOrDie("Blob"))(y,C)))}function bo(a){return new aW(function(b,c){bs(a).fold(function(){c("uri is not base64: "+a)},b)})}function aw(a){return new aW(function(b){var c=new bH;c.onloadend=function(){b(c.result)},c.readAsDataURL(a)})}var bE={blobToImage:bI,imageToBlob:function(a){var b=a.src;return 0===b.indexOf("data:")?bo(b):bg(b)},blobToArrayBuffer:function(a){return new aW(function(b){var c=new bH;c.onloadend=function(){b(c.result)},c.readAsArrayBuffer(a)})},blobToDataUri:aw,blobToBase64:function(a){return aw(a).then(function(b){return b.split(",")[1]})},dataUriToBlobSync:bs,canvasToBlob:function(a,c,b){return c=c||"image/png",HTMLCanvasElement.prototype.toBlob?new aW(function(d){a.toBlob(function(e){d(e)},c,b)}):bo(a.toDataURL(c,b))},canvasToDataURL:function(a,b,c){return b=b||"image/png",a.then(function(d){return d.toDataURL(b,c)})},blobToCanvas:function(a){return bI(a).then(function(b){var c,d;return c=b,URL.revokeObjectURL(c.src),d=aV.create(aK.getWidth(b),aK.getHeight(b)),aV.get2dContext(d).drawImage(b,0,0),d})},uriToBlob:function(a){return 0===a.indexOf("blob:")?bg(a):0===a.indexOf("data:")?bo(a):null}},bj=function(a){return bE.blobToImage(a)},bC=function(a){return bE.imageToBlob(a)};function a5(a,c,f){var b=c.type;function d(g,h){return a.then(function(e){return bE.canvasToDataURL(e,g,h)})}return{getType:aO.constant(b),toBlob:function(){return aW.resolve(c)},toDataURL:function(){return f},toBase64:function(){return f.split(",")[1]},toAdjustedBlob:function(g,h){return a.then(function(e){return bE.canvasToBlob(e,g,h)})},toAdjustedDataURL:d,toAdjustedBase64:function(g,h){return d(g,h).then(function(e){return e.split(",")[1]})},toCanvas:function(){return a.then(aV.clone)}}}function bu(a){return bE.blobToDataUri(a).then(function(b){return a5(bE.blobToCanvas(a),a,b)})}var bz={fromBlob:bu,fromCanvas:function(b,a){return bE.canvasToBlob(b,a).then(function(c){return a5(aW.resolve(b),c,b.toDataURL())})},fromImage:function(a){return bE.imageToBlob(a).then(function(b){return bu(b)})},fromBlobAndUrlSync:function(a,b){return a5(bE.blobToCanvas(a),a,b)}};function bB(a,b,c){return c<(a=parseFloat(a))?a=c:a<b&&(a=b),a}var bn=[0,0.01,0.02,0.04,0.05,0.06,0.07,0.08,0.1,0.11,0.12,0.14,0.15,0.16,0.17,0.18,0.2,0.21,0.22,0.24,0.25,0.27,0.28,0.3,0.32,0.34,0.36,0.38,0.4,0.42,0.44,0.46,0.48,0.5,0.53,0.56,0.59,0.62,0.65,0.68,0.71,0.74,0.77,0.8,0.83,0.86,0.89,0.92,0.95,0.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function bd(f,h){var k,g,j,d,b=[],c=new Array(10);for(k=0;k<5;k++){for(g=0;g<5;g++){b[g]=h[g+5*k]}for(g=0;g<5;g++){for(j=d=0;j<5;j++){d+=f[g+5*j]*b[j]}c[g+5*k]=d}}return c}function bf(a,b){return b=bB(b,0,1),a.map(function(c,d){return d%6==0?c=1-(1-c)*b:c*=b,bB(c,0,1)})}var bq={identity:function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},adjust:bf,multiply:bd,adjustContrast:function(a,b){var c;return b=bB(b,-1,1),bd(a,[(c=(b*=100)<0?127+b/100*127:127*(c=0==(c=b%1)?bn[b]:bn[Math.floor(b)]*(1-c)+bn[Math.floor(b)+1]*c)+127)/127,0,0,0,0.5*(127-c),0,c/127,0,0,0.5*(127-c),0,0,c/127,0,0.5*(127-c),0,0,0,1,0,0,0,0,0,1])},adjustBrightness:function(a,b){return bd(a,[1,0,0,0,b=bB(255*b,-255,255),0,1,0,0,b,0,0,1,0,b,0,0,0,1,0,0,0,0,0,1])},adjustSaturation:function(a,b){var c;return bd(a,[0.3086*(1-(c=1+(0<(b=bB(b,-1,1))?3*b:b)))+c,0.6094*(1-c),0.082*(1-c),0,0,0.3086*(1-c),0.6094*(1-c)+c,0.082*(1-c),0,0,0.3086*(1-c),0.6094*(1-c),0.082*(1-c)+c,0,0,0,0,0,1,0,0,0,0,0,1])},adjustHue:function(d,g){var j,f,h,c,b;return g=bB(g,-180,180)/180*Math.PI,bd(d,[(h=0.213)+0.787*(j=Math.cos(g))+(f=Math.sin(g))*-h,(c=0.715)+j*-c+f*-c,(b=0.072)+j*-b+0.928*f,0,0,h+j*-h+0.143*f,c+j*(1-c)+0.14*f,b+j*-b+-0.283*f,0,0,h+j*-h+-0.787*f,c+j*-c+f*c,b+0.928*j+f*b,0,0,0,0,0,1,0,0,0,0,0,1])},adjustColors:function(a,c,d,b){return bd(a,[c=bB(c,0,2),0,0,0,0,0,d=bB(d,0,2),0,0,0,0,0,b=bB(b,0,2),0,0,0,0,0,1,0,0,0,0,0,1])},adjustSepia:function(a,b){return bd(a,bf([0.393,0.769,0.189,0,0,0.349,0.686,0.168,0,0,0.272,0.534,0.131,0,0,0,0,0,1,0,0,0,0,0,1],b=bB(b,0,1)))},adjustGrayscale:function(a,b){return bd(a,bf([0.33,0.34,0.33,0,0,0.33,0.34,0.33,0,0,0.33,0.34,0.33,0,0,0,0,0,1,0,0,0,0,0,1],b=bB(b,0,1)))}};function aJ(b,c){return b.toCanvas().then(function(d){return g=d,j=b.getType(),f=c,a=aV.get2dContext(g),h=function(J,ae){var Q,M,P,W,b7,H=J.data,bt=ae[0],U=ae[1],K=ae[2],Z=ae[3],at=ae[4],X=ae[5],O=ae[6],Y=ae[7],S=ae[8],G=ae[9],A=ae[10],b6=ae[11],F=ae[12],E=ae[13],z=ae[14],D=ae[15],q=ae[16],V=ae[17],L=ae[18],N=ae[19];for(b7=0;b7<H.length;b7+=4){Q=H[b7],M=H[b7+1],P=H[b7+2],W=H[b7+3],H[b7]=Q*bt+M*U+P*K+W*Z+at,H[b7+1]=Q*X+M*O+P*Y+W*S+G,H[b7+2]=Q*A+M*b6+P*F+W*E+z,H[b7+3]=Q*D+M*q+P*V+W*L+N}return J}(a.getImageData(0,0,g.width,g.height),f),a.putImageData(h,0,0),bz.fromCanvas(g,j);var g,j,f,h,a})}function bT(a,b){return a.toCanvas().then(function(f){return h=f,k=a.getType(),g=b,c=aV.get2dContext(h),j=c.getImageData(0,0,h.width,h.height),d=c.getImageData(0,0,h.width,h.height),d=function(B,N,G){var D,F,J,R,A,P,I,C,M,O,K,E,L,H,z,q,Q;function x(i,l,m){return m<i?i=m:i<l&&(i=l),i}for(J=Math.round(Math.sqrt(G.length)),R=Math.floor(J/2),D=B.data,F=N.data,q=B.width,Q=B.height,P=0;P<Q;P++){for(A=0;A<q;A++){for(I=C=M=0,K=0;K<J;K++){for(O=0;O<J;O++){E=x(A+O-R,0,q-1),L=x(P+K-R,0,Q-1),H=4*(L*q+E),z=G[K*J+O],I+=D[H]*z,C+=D[H+1]*z,M+=D[H+2]*z}}F[H=4*(P*q+A)]=x(I,0,255),F[H+1]=x(C,0,255),F[H+2]=x(M,0,255)}}return N}(j,d,g),c.putImageData(d,0,0),bz.fromCanvas(h,k);var h,k,g,j,d,c})}function bb(a){return function(b,c){return b.toCanvas().then(function(d){return function(h,k,m){var j,l,g=aV.get2dContext(h),f=new Array(256);for(l=0;l<f.length;l++){f[l]=a(l,m)}return j=function(i,p){var q,o=i.data;for(q=0;q<o.length;q+=4){o[q]=p[o[q]],o[q+1]=p[o[q+1]],o[q+2]=p[o[q+2]]}return i}(g.getImageData(0,0,h.width,h.height),f),g.putImageData(j,0,0),bz.fromCanvas(h,k)}(d,b.getType(),c)})}}function bA(a){return function(b,c){return aJ(b,a(bq.identity(),c))}}function bv(a){return function(b){return bT(b,a)}}var bw,a8={invert:(bw=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0],function(a){return aJ(a,bw)}),brightness:bA(bq.adjustBrightness),hue:bA(bq.adjustHue),saturate:bA(bq.adjustSaturation),contrast:bA(bq.adjustContrast),grayscale:bA(bq.adjustGrayscale),sepia:bA(bq.adjustSepia),colorize:function(a,c,d,b){return aJ(a,bq.adjustColors(bq.identity(),c,d,b))},sharpen:bv([0,-1,0,-1,5,-1,0,-1,0]),emboss:bv([-2,-1,0,-1,1,1,0,1,2]),gamma:bb(function(a,b){return 255*Math.pow(a/255,1-b)}),exposure:bb(function(a,b){return 255*(1-Math.exp(-a/255*b))}),colorFilter:aJ,convoluteFilter:bT},bm={scale:function aY(w,g,b){var e=aK.getWidth(w),j=aK.getHeight(w),q=g/e,v=b/j,p=!1;(q<0.5||2<q)&&(q=q<0.5?0.5:2,p=!0),(v<0.5||2<v)&&(v=v<0.5?0.5:2,p=!0);var h,x,k,m=(h=w,x=q,k=v,new aW(function(f){var s=aK.getWidth(h),y=aK.getHeight(h),l=Math.floor(s*x),u=Math.floor(y*k),d=aV.create(l,u),c=aV.get2dContext(d);c.drawImage(h,0,0,s,y,0,0,l,u),f(d)}));return p?m.then(function(a){return aY(a,g,b)}):m}},bi={rotate:function(b,a){return b.toCanvas().then(function(g){return j=g,l=b.getType(),h=a,k=aV.create(j.width,j.height),f=aV.get2dContext(k),90!=(h=h<(d=c=0)?360+h:h)&&270!=h||aV.resize(k,k.height,k.width),90!=h&&180!=h||(c=k.width),270!=h&&180!=h||(d=k.height),f.translate(c,d),f.rotate(h*Math.PI/180),f.drawImage(j,0,0),bz.fromCanvas(k,l);var j,l,h,k,f,c,d})},flip:function(b,c){return b.toCanvas().then(function(d){return g=d,j=b.getType(),f=c,h=aV.create(g.width,g.height),a=aV.get2dContext(h),"v"==f?(a.scale(1,-1),a.drawImage(g,0,-h.height)):(a.scale(-1,1),a.drawImage(g,-h.width,0)),bz.fromCanvas(h,j);var g,j,f,h,a})},crop:function(h,a,b,e,g){return h.toCanvas().then(function(j){return l=j,p=h.getType(),k=a,m=b,f=e,c=g,d=aV.create(f,c),aV.get2dContext(d).drawImage(l,-k,-m),bz.fromCanvas(d,p);var l,p,k,m,f,c,d})},resize:function(b,c,a){return b.toCanvas().then(function(d){return bm.scale(d,c,a).then(function(e){return bz.fromCanvas(e,b.getType())})})}},b5={invert:function(a){return a8.invert(a)},sharpen:function(a){return a8.sharpen(a)},emboss:function(a){return a8.emboss(a)},brightness:function(a,b){return a8.brightness(a,b)},hue:function(a,b){return a8.hue(a,b)},saturate:function(a,b){return a8.saturate(a,b)},contrast:function(a,b){return a8.contrast(a,b)},grayscale:function(a,b){return a8.grayscale(a,b)},sepia:function(a,b){return a8.sepia(a,b)},colorize:function(a,c,d,b){return a8.colorize(a,c,d,b)},gamma:function(a,b){return a8.gamma(a,b)},exposure:function(a,b){return a8.exposure(a,b)},flip:function(a,b){return bi.flip(a,b)},crop:function(a,c,f,b,d){return bi.crop(a,c,f,b,d)},resize:function(a,b,c){return bi.resize(a,b,c)},rotate:function(a,b){return bi.rotate(a,b)}},ba=function(a){return a.toBlob()},bY={blobToImageResult:function(a){return bz.fromBlob(a)},fromBlobAndUrlSync:function(a,b){return bz.fromBlobAndUrlSync(a,b)},imageToImageResult:function(a){return bz.fromImage(a)},imageResultToBlob:function(a,b,c){return b===undefined&&c===undefined?ba(a):a.toAdjustedBlob(b,c)},imageResultToOriginalBlob:ba,imageResultToDataURL:function(a){return a.toDataURL()}},aA=function(){return bF.getOrDie("URL")},au={createObjectURL:function(a){return aA().createObjectURL(a)},revokeObjectURL:function(a){aA().revokeObjectURL(a)}},bG=tinymce.util.Tools.resolve("tinymce.util.Delay"),aH=tinymce.util.Tools.resolve("tinymce.util.Promise"),ar=tinymce.util.Tools.resolve("tinymce.util.URI"),bW=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),bO=tinymce.util.Tools.resolve("tinymce.ui.Factory"),bU=tinymce.util.Tools.resolve("tinymce.geom.Rect"),aj=function(a){return new aH(function(b){var c=function(){a.removeEventListener("load",c),b(a)};a.complete?b(a):a.addEventListener("load",c)})},a6=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),am=tinymce.util.Tools.resolve("tinymce.util.Observable"),bJ=tinymce.util.Tools.resolve("tinymce.util.VK"),bL=0,ao={create:function(a){return new (bO.get("Control").extend({Defaults:{classes:"imagepanel"},selection:function(b){return arguments.length?(this.state.set("rect",b),this):this.state.get("rect")},imageSize:function(){var b=this.state.get("viewRect");return{w:b.w,h:b.h}},toggleCropRect:function(b){this.state.set("cropEnabled",b)},imageSrc:function(c){var d=this,b=new Image;b.src=c,aj(b).then(function(){var f,h,i=d.state.get("viewRect");if((h=d.$el.find("img"))[0]){h.replaceWith(b)}else{var g=document.createElement("div");g.className="mce-imagepanel-bg",d.getEl().appendChild(g),d.getEl().appendChild(b)}f={x:0,y:0,w:b.naturalWidth,h:b.naturalHeight},d.state.set("viewRect",f),d.state.set("rect",bU.inflate(f,-20,-20)),i&&i.w===f.w&&i.h===f.h||d.zoomFit(),d.repaintImage(),d.fire("load")})},zoom:function(b){return arguments.length?(this.state.set("zoom",b),this):this.state.get("zoom")},postRender:function(){return this.imageSrc(this.settings.imageSrc),this._super()},zoomFit:function(){var c,f,h,d,g,b;c=this.$el.find("img"),f=this.getEl().clientWidth,h=this.getEl().clientHeight,d=c[0].naturalWidth,g=c[0].naturalHeight,1<=(b=Math.min((f-10)/d,(h-10)/g))&&(b=1),this.zoom(b)},repaintImage:function(){var q,j,f,b,d,h,m,p,k,g,v;v=this.getEl(),k=this.zoom(),g=this.state.get("rect"),m=this.$el.find("img"),p=this.$el.find(".mce-imagepanel-bg"),d=v.offsetWidth,h=v.offsetHeight,f=m[0].naturalWidth*k,b=m[0].naturalHeight*k,q=Math.max(0,d/2-f/2),j=Math.max(0,h/2-b/2),m.css({left:q,top:j,width:f,height:b}),p.css({left:q,top:j,width:f,height:b}),this.cropRect&&(this.cropRect.setRect({x:g.x*k+q,y:g.y*k+j,w:g.w*k,h:g.h*k}),this.cropRect.setClampRect({x:q,y:j,w:f,h:b}),this.cropRect.setViewPortRect({x:0,y:0,w:d,h:h}))},bindStates:function(){var b=this;function c(d){b.cropRect=function(v,q,G,j,m){var z,D,F,w,A="mce-",E=A+"crid-"+bL++;function B(f,g){return{x:g.x-f.x,y:g.y-f.y,w:g.w,h:g.h}}function C(J,p,h,f){var g,l,H,I,s;g=p.x,l=p.y,H=p.w,I=p.h,g+=h*J.deltaX,l+=f*J.deltaY,(H+=h*J.deltaW)<20&&(H=20),(I+=f*J.deltaH)<20&&(I=20),s=v=bU.clamp({x:g,y:l,w:H,h:I},G,"move"===J.name),s=B(G,s),z.fire("updateRect",{rect:s}),y(s)}function x(g){function f(h,i){i.h<0&&(i.h=0),i.w<0&&(i.w=0),a6("#"+E+"-"+h,j).css({left:i.x,top:i.y,width:i.w,height:i.h})}a9.each(D,function(e){a6("#"+E+"-"+e.name,j).css({left:g.w*e.xMul+g.x,top:g.h*e.yMul+g.y})}),f("top",{x:q.x,y:q.y,w:q.w,h:g.y-q.y}),f("right",{x:g.x+g.w,y:g.y,w:q.w-g.x-g.w+q.x,h:g.h}),f("bottom",{x:q.x,y:g.y+g.h,w:q.w,h:q.h-g.y-g.h+q.y}),f("left",{x:q.x,y:g.y,w:g.x-q.x,h:g.h}),f("move",g)}function k(e){x(v=e)}function y(f){var g,h;k((g=G,{x:(h=f).x+g.x,y:h.y+g.y,w:h.w,h:h.h}))}return D=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],w=["top","right","bottom","left"],a6('<div id="'+E+'" class="'+A+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(j),a9.each(w,function(e){a6("#"+E,j).append('<div id="'+E+"-"+e+'"class="'+A+'croprect-block" style="display: none" data-mce-bogus="all">')}),a9.each(D,function(e){a6("#"+E,j).append('<div id="'+E+"-"+e.name+'" class="'+A+"croprect-handle "+A+"croprect-handle-"+e.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+e.label+'" aria-grabbed="false">')}),F=a9.map(D,function(f){var g;return new (bO.get("DragHelper"))(E,{document:j.ownerDocument,handle:E+"-"+f.name,start:function(){g=v},drag:function(e){C(f,g,e.deltaX,e.deltaY)}})}),x(v),a6(j).on("focusin focusout",function(e){a6(e.target).attr("aria-grabbed","focus"===e.type)}),a6(j).on("keydown",function(h){var g;function f(i,p,u,l,s){i.stopPropagation(),i.preventDefault(),C(g,u,l,s)}switch(a9.each(D,function(e){if(h.target.id===E+"-"+e.name){return g=e,!1}}),h.keyCode){case bJ.LEFT:f(h,0,v,-10,0);break;case bJ.RIGHT:f(h,0,v,10,0);break;case bJ.UP:f(h,0,v,0,-10);break;case bJ.DOWN:f(h,0,v,0,10);break;case bJ.ENTER:case bJ.SPACEBAR:h.preventDefault(),m()}}),z=a9.extend({toggleVisibility:function(f){var g;g=a9.map(D,function(e){return"#"+E+"-"+e.name}).concat(a9.map(w,function(e){return"#"+E+"-"+e})).join(","),f?a6(g,j).show():a6(g,j).hide()},setClampRect:function(e){G=e,x(v)},setRect:k,getInnerRect:function(){return B(G,v)},setInnerRect:y,setViewPortRect:function(e){q=e,x(v)},destroy:function(){a9.each(F,function(e){e.destroy()}),F=[]}},am)}(d,b.state.get("viewRect"),b.state.get("viewRect"),b.getEl(),function(){b.fire("crop")}),b.cropRect.on("updateRect",function(f){var g=f.rect,h=b.zoom();g={x:Math.round(g.x/h),y:Math.round(g.y/h),w:Math.round(g.w/h),h:Math.round(g.h/h)},b.state.set("rect",g)}),b.on("remove",b.cropRect.destroy)}b.state.on("change:cropEnabled",function(d){b.cropRect.toggleVisibility(d.value),b.repaintImage()}),b.state.on("change:zoom",function(){b.repaintImage()}),b.state.on("change:rect",function(d){var f=d.value;b.cropRect||c(f),b.cropRect.setRect(f)})}}))(a)}};function bQ(a){return{blob:a,url:au.createObjectURL(a)}}function a2(a){a&&au.revokeObjectURL(a.url)}function ag(a){a9.each(a,a2)}function b0(cB,cJ,cq,cF){var cp,cw,cs,cH,cv,cy,cr,cE,cG,cC,cu,cD,cx,co,cl,cI,cn,cm,at,ca,Z,cz,cg,ch,cA,ci,Y,b8=function(){var d=[],b=-1;function a(){return 0<b}function c(){return -1!==b&&b<d.length-1}return{data:d,add:function(f){var g;return g=d.splice(++b),d.push(f),{state:f,removed:g}},undo:function(){if(a()){return d[--b]}},redo:function(){if(c()){return d[++b]}},canUndo:a,canRedo:c}}(),b6=function(a){return cB.rtl?a.reverse():a};function ck(a){var c,f,b,d;c=cp.find("#w")[0],f=cp.find("#h")[0],b=parseInt(c.value(),10),d=parseInt(f.value(),10),cp.find("#constrain")[0].checked()&&ch&&cA&&b&&d&&("w"===a.control.settings.name?(d=Math.round(b*ci),f.value(d)):(b=Math.round(d*Y),c.value(b))),ch=b,cA=d}function cf(a){return Math.round(100*a)+"%"}function ae(){cp.find("#undo").disabled(!b8.canUndo()),cp.find("#redo").disabled(!b8.canRedo()),cp.statusbar.find("#save").disabled(!b8.canUndo())}function ce(){cp.find("#undo").disabled(!0),cp.find("#redo").disabled(!0)}function cK(a){a&&cE.imageSrc(a.url)}function b9(a){return function(){var b=a9.grep(cg,function(c){return c.settings.name!==a});a9.each(b,function(c){c.hide()}),a.show(),a.focus()}}function cb(a){cK(cH=bQ(a))}function cd(a){cK(cJ=bQ(a)),ag(b8.add(cJ).removed),ae()}function bt(){var a=cE.selection();bY.blobToImageResult(cJ.blob).then(function(b){b5.crop(b,a.x,a.y,a.w,a.h).then(cj).then(function(c){cd(c),Q()})})}var K=function(a){var b=[].slice.call(arguments,1);return function(){var c=cH||cJ;bY.blobToImageResult(c.blob).then(function(d){a.apply(this,[d].concat(b)).then(cj).then(cb)})}};function Q(){cK(cJ),a2(cH),b9(cw)(),ae()}function b7(){cH?(cd(cH.blob),Q()):function a(b,c){cH?c():setTimeout(function(){0<b--?a(b,c):cB.windowManager.alert("Error: failed to apply image operation.")},10)}(100,b7)}function ct(a){return bO.create("Form",{layout:"flex",direction:"row",labelGap:5,border:"0 0 1 0",align:"center",pack:"center",padding:"0 10 0 10",spacing:5,flex:0,minHeight:60,defaults:{classes:"imagetool",type:"button"},items:a})}var cj=function(a){return a.toBlob()};function J(a,b){return ct(b6([{text:"Back",onclick:Q},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:b7}])).hide().on("show",function(){ce(),bY.blobToImageResult(cJ.blob).then(function(c){return b(c)}).then(cj).then(function(c){var d=bQ(c);cK(d),a2(cH),cH=d})})}function cc(a,f,c,b,d){return ct(b6([{text:"Back",onclick:Q},{type:"spacer",flex:1},{type:"slider",flex:1,ondragend:function(g){var h;h=g.value,bY.blobToImageResult(cJ.blob).then(function(e){return f(e,h)}).then(cj).then(function(i){var j=bQ(i);cK(j),a2(cH),cH=j})},minValue:cB.rtl?d:b,maxValue:cB.rtl?b:d,value:c,previewFilter:cf},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:b7}])).hide().on("show",function(){this.find("slider").value(c),ce()})}cv=ct(b6([{text:"Back",onclick:Q},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:bt}])).hide().on("show hide",function(a){cE.toggleCropRect("show"===a.type)}).on("show",ce),cy=ct(b6([{text:"Back",onclick:Q},{type:"spacer",flex:1},{type:"textbox",name:"w",label:"Width",size:4,onkeyup:ck},{type:"textbox",name:"h",label:"Height",size:4,onkeyup:ck},{type:"checkbox",name:"constrain",text:"Constrain proportions",checked:!0,onchange:function(a){!0===a.control.value()&&(ci=cA/ch,Y=ch/cA)}},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:"submit"}])).hide().on("submit",function(a){var b=parseInt(cp.find("#w").value(),10),c=parseInt(cp.find("#h").value(),10);a.preventDefault(),function(g){for(var d=[],h=1;h<arguments.length;h++){d[h-1]=arguments[h]}var f=[].slice.call(arguments,1);return function(){bY.blobToImageResult(cJ.blob).then(function(e){g.apply(this,[e].concat(f)).then(cj).then(cd)})}}(b5.resize,b,c)(),Q()}).on("show",ce),cr=ct(b6([{text:"Back",onclick:Q},{type:"spacer",flex:1},{icon:"fliph",tooltip:"Flip horizontally",onclick:K(b5.flip,"h")},{icon:"flipv",tooltip:"Flip vertically",onclick:K(b5.flip,"v")},{icon:"rotateleft",tooltip:"Rotate counterclockwise",onclick:K(b5.rotate,-90)},{icon:"rotateright",tooltip:"Rotate clockwise",onclick:K(b5.rotate,90)},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:b7}])).hide().on("show",ce),cu=J(0,b5.invert),at=J(0,b5.sharpen),ca=J(0,b5.emboss),cD=cc(0,b5.brightness,0,-1,1),cx=cc(0,b5.hue,180,0,360),co=cc(0,b5.saturate,0,-1,1),cl=cc(0,b5.contrast,0,-1,1),cI=cc(0,b5.grayscale,0,0,1),cn=cc(0,b5.sepia,0,0,1),cm=function(a,d){function c(){var h,i,g;h=cp.find("#r")[0].value(),i=cp.find("#g")[0].value(),g=cp.find("#b")[0].value(),bY.blobToImageResult(cJ.blob).then(function(e){return d(e,h,i,g)}).then(cj).then(function(j){var k=bQ(j);cK(k),a2(cH),cH=k})}var f=cB.rtl?2:0,b=cB.rtl?0:2;return ct(b6([{text:"Back",onclick:Q},{type:"spacer",flex:1},{type:"slider",label:"R",name:"r",minValue:f,value:1,maxValue:b,ondragend:c,previewFilter:cf},{type:"slider",label:"G",name:"g",minValue:f,value:1,maxValue:b,ondragend:c,previewFilter:cf},{type:"slider",label:"B",name:"b",minValue:f,value:1,maxValue:b,ondragend:c,previewFilter:cf},{type:"spacer",flex:1},{text:"Apply",subtype:"primary",onclick:b7}])).hide().on("show",function(){cp.find("#r,#g,#b").value(1),ce()})}(0,b5.colorize),Z=cc(0,b5.gamma,0,-1,1),cz=cc(0,b5.exposure,1,0,2),cs=ct(b6([{text:"Back",onclick:Q},{type:"spacer",flex:1},{text:"hue",icon:"hue",onclick:b9(cx)},{text:"saturate",icon:"saturate",onclick:b9(co)},{text:"sepia",icon:"sepia",onclick:b9(cn)},{text:"emboss",icon:"emboss",onclick:b9(ca)},{text:"exposure",icon:"exposure",onclick:b9(cz)},{type:"spacer",flex:1}])).hide(),cw=ct(b6([{tooltip:"Crop",icon:"crop",onclick:b9(cv)},{tooltip:"Resize",icon:"resize2",onclick:b9(cy)},{tooltip:"Orientation",icon:"orientation",onclick:b9(cr)},{tooltip:"Brightness",icon:"sun",onclick:b9(cD)},{tooltip:"Sharpen",icon:"sharpen",onclick:b9(at)},{tooltip:"Contrast",icon:"contrast",onclick:b9(cl)},{tooltip:"Color levels",icon:"drop",onclick:b9(cm)},{tooltip:"Gamma",icon:"gamma",onclick:b9(Z)},{tooltip:"Invert",icon:"invert",onclick:b9(cu)}])),cE=ao.create({flex:1,imageSrc:cJ.url}),cG=bO.create("Container",{layout:"flex",direction:"column",pack:"start",border:"0 1 0 0",padding:5,spacing:5,items:[{type:"button",icon:"undo",tooltip:"Undo",name:"undo",onclick:function(){cK(cJ=b8.undo()),ae()}},{type:"button",icon:"redo",tooltip:"Redo",name:"redo",onclick:function(){cK(cJ=b8.redo()),ae()}},{type:"button",icon:"zoomin",tooltip:"Zoom in",onclick:function(){var a=cE.zoom();a<2&&(a+=0.1),cE.zoom(a)}},{type:"button",icon:"zoomout",tooltip:"Zoom out",onclick:function(){var a=cE.zoom();0.1<a&&(a-=0.1),cE.zoom(a)}}]}),cC=bO.create("Container",{type:"container",layout:"flex",direction:"row",align:"stretch",flex:1,items:b6([cG,cE])}),cg=[cw,cv,cy,cr,cs,cu,cD,cx,co,cl,cI,cn,cm,at,ca,Z,cz],(cp=cB.windowManager.open({layout:"flex",direction:"column",align:"stretch",minWidth:Math.min(bW.DOM.getViewPort().w,800),minHeight:Math.min(bW.DOM.getViewPort().h,650),title:"Edit image",items:cg.concat([cC]),buttons:b6([{text:"Save",name:"save",subtype:"primary",onclick:function(){cq(cJ.blob),cp.close()}},{text:"Cancel",onclick:"close"}])})).on("close",function(){cF(),ag(b8.data),cH=b8=null}),b8.add(cJ),ae(),cE.on("load",function(){ch=cE.imageSize().w,cA=cE.imageSize().h,ci=cA/ch,Y=ch/cA,cp.find("#w").value(ch),cp.find("#h").value(cA)}),cE.on("crop",bt)}var ah={edit:function(b,a){return new aH(function(c,d){return a.toBlob().then(function(e){b0(b,bQ(e),c,d)})})}},bc={getImageSize:function(a){var c,d;function b(e){return/^[0-9\.]+px$/.test(e)}return c=a.style.width,d=a.style.height,c||d?b(c)&&b(d)?{w:parseInt(c,10),h:parseInt(d,10)}:null:(c=a.width,d=a.height,c&&d?{w:parseInt(c,10),h:parseInt(d,10)}:null)},setImageSize:function(a,c){var d,b;c&&(d=a.style.width,b=a.style.height,(d||b)&&(a.style.width=c.w+"px",a.style.height=c.h+"px",a.removeAttribute("data-mce-style")),d=a.width,b=a.height,(d||b)&&(a.setAttribute("width",c.w),a.setAttribute("height",c.h)))},getNaturalImageSize:function(a){return{w:a.naturalWidth,h:a.naturalHeight}}},bR=function(a){return function(b){return function(c){if(null===c){return"null"}var d=typeof c;return"object"===d&&Array.prototype.isPrototypeOf(c)?"array":"object"===d&&String.prototype.isPrototypeOf(c)?"string":d}(b)===a}},aa={isString:bR("string"),isObject:bR("object"),isArray:bR("array"),isNull:bR("null"),isBoolean:bR("boolean"),isUndefined:bR("undefined"),isFunction:bR("function"),isNumber:bR("number")},a7=(Array.prototype.indexOf,undefined,Array.prototype.push,Array.prototype.slice,aa.isFunction(Array.from)&&Array.from,function(a,c){for(var f=0,b=a.length;f<b;f++){var d=a[f];if(c(d,f,a)){return bl.some(d)}}return bl.none()});function bK(){return new (bF.getOrDie("XMLHttpRequest"))}var ak=function(a){return null!==a&&a!==undefined},bV=function(a,b){var c;return c=b.reduce(function(d,f){return ak(d)?d[f]:undefined},a),ak(c)?c:null},br=function(a){return new aH(function(c){var b=new bH;b.onload=function(d){var f=d.target;c(f.result)},b.readAsText(a)})},bZ=function(b,a,c){return new aH(function(d){var e;(e=new bK).onreadystatechange=function(){4===e.readyState&&d({status:e.status,blob:this.response})},e.open("GET",b,!0),e.withCredentials=c,a9.each(a,function(f,g){e.setRequestHeader(g,f)}),e.responseType="blob",e.send()})},bk=function(a){var b;try{b=JSON.parse(a)}catch(c){}return b},bp=[{code:404,message:"Could not find Image Proxy"},{code:403,message:"Rejected request"},{code:0,message:"Incorrect Image Proxy URL"}],av=[{type:"key_missing",message:"The request did not include an api key."},{type:"key_not_found",message:"The provided api key could not be found."},{type:"domain_not_trusted",message:"The api key is not valid for the request origins."}],b1=function(a){return"ImageProxy HTTP error: "+a7(bp,function(b){return a===b.code}).fold(aO.constant("Unknown ImageProxy error"),function(b){return b.message})},al=function(a){var b=b1(a);return aH.reject(b)},b4=function(a){return a7(av,function(b){return b.type===a}).fold(aO.constant("Unknown service error"),function(b){return b.message})},ad=function(a,b){return br(b).then(function(c){var f,g,d=(f=bk(c),"ImageProxy Service error: "+((g=bV(f,["error","type"]))?b4(g):"Invalid JSON in service error message"));return aH.reject(d)})},bM=function(a,b){return 400===(c=a)||403===c||500===c?ad(0,b):al(a);var c},ab=al,aI=function(b,d){var g,c,f,a={"Content-Type":"application/json;charset=UTF-8","tiny-api-key":d};return bZ((g=b,c=d,f=-1===g.indexOf("?")?"?":"&",/[?&]apiKey=/.test(g)||!c?g:g+f+"apiKey="+encodeURIComponent(c)),a,!1).then(function(e){return e.status<200||300<=e.status?bM(e.status,e.blob):aH.resolve(e.blob)})},aq=function(a,b,c){return b?aI(a,b):bZ(a,{},c).then(function(d){return d.status<200||300<=d.status?ab(d.status):aH.resolve(d.blob)})},aP=0,bP=function(a,b){a.notificationManager.open({text:b,type:"error"})},ac=function(a){return a.selection.getNode()},be=function(a,b){var c=b.src;return 0===c.indexOf("data:")||0===c.indexOf("blob:")||new ar(c).host===a.documentBaseURI.host},ai=function(a,b){return -1!==a9.inArray(a.getParam("imagetools_cors_hosts",[],"string[]"),new ar(b.src).host)},bX=function(d,g){var j,f,h,c,b=g.src;return ai(d,g)?aq(g.src,null,(f=d,h=g,-1!==a9.inArray(f.getParam("imagetools_credentials_hosts",[],"string[]"),new ar(h.src).host))):be(d,g)?bC(g):(b=d.getParam("imagetools_proxy"),b+=(-1===b.indexOf("?")?"?":"&")+"url="+encodeURIComponent(g.src),j=(c=d).getParam("api_key",c.getParam("imagetools_api_key","","string"),"string"),aq(b,j,!1))},b2=function(a){var b;return(b=a.editorUpload.blobCache.getByUri(ac(a).src))?aH.resolve(b.blob()):bX(a,ac(a))},an=function(a){clearTimeout(a.get())},aB=function(h,a,b,e,g){return a.toBlob().then(function(j){var l,p,k,m,f,c,d;return k=h.editorUpload.blobCache,l=(f=ac(h)).src,h.getParam("images_reuse_filename",!1,"boolean")&&((m=k.getByUri(l))?(l=m.uri(),p=m.name()):(c=h,p=(d=l.match(/\/([^\/\?]+)?\.(?:jpeg|jpg|png|gif)(?:\?|$)/i))?c.dom.encode(d[1]):null)),m=k.create({id:"imagetools"+aP++,blob:j,base64:a.toBase64(),uri:l,name:p}),k.add(m),h.undoManager.transact(function(){h.$(f).on("load",function i(){var q,s,o;h.$(f).off("load",i),h.nodeChanged(),b?h.editorUpload.uploadImagesAuto():(an(e),q=h,s=e,o=bG.setEditorTimeout(q,function(){q.editorUpload.uploadImagesAuto()},q.getParam("images_upload_timeout",30000,"number")),s.set(o))}),g&&h.$(f).attr({width:g.w,height:g.h}),h.$(f).attr({src:m.blobUri()}).removeAttr("data-mce-src")}),m})},bS=function(c,d,a,b){return function(){return c._scanForImages().then(aO.curry(b2,c)).then(bY.blobToImageResult).then(a).then(function(e){return aB(c,e,!1,d,b)},function(e){bP(c,e)})}},ap=function(c,a,b){return function(){var d=bc.getImageSize(ac(c)),f=d?{w:d.h,h:d.w}:null;return bS(c,a,function(e){return b5.rotate(e,b)},f)()}},bD=function(a,b,c){return function(){return bS(a,b,function(d){return b5.flip(d,c)})()}},af=function(b,a){return function(){var d=ac(b),c=bc.getNaturalImageSize(d),e=function(f){return new aH(function(g){bj(f).then(function(h){var i=bc.getNaturalImageSize(h);c.w===i.w&&c.h===i.h||bc.getImageSize(d)&&bc.setImageSize(d,i),au.revokeObjectURL(h.src),g(f)})})};b2(b).then(bY.blobToImageResult).then(aO.curry(function(g,f){return ah.edit(g,f).then(e).then(bY.blobToImageResult).then(function(h){return aB(g,h,!0,a)},function(){})},b),function(f){bP(b,f)})}},bx=function(a,b){return a.dom.is(b,"img:not([data-mce-object],[data-mce-placeholder])")&&(be(a,b)||ai(a,b)||a.settings.imagetools_proxy)},b3=an,aU=function(b,a){a9.each({mceImageRotateLeft:ap(b,a,-90),mceImageRotateRight:ap(b,a,90),mceImageFlipVertical:bD(b,a,"v"),mceImageFlipHorizontal:bD(b,a,"h"),mceEditImage:af(b,a)},function(c,d){b.addCommand(d,c)})},aN=function(c,a,b){c.on("NodeChange",function(d){var f=b.get();f&&f.src!==d.element.src&&(b3(a),c.editorUpload.uploadImagesAuto(),b.set(null)),bx(c,d.element)&&b.set(d.element)})},bN=function(a){a.addButton("rotateleft",{title:"Rotate counterclockwise",cmd:"mceImageRotateLeft"}),a.addButton("rotateright",{title:"Rotate clockwise",cmd:"mceImageRotateRight"}),a.addButton("flipv",{title:"Flip vertically",cmd:"mceImageFlipVertical"}),a.addButton("fliph",{title:"Flip horizontally",cmd:"mceImageFlipHorizontal"}),a.addButton("editimage",{title:"Edit image",cmd:"mceEditImage"}),a.addButton("imageoptions",{title:"Image options",icon:"options",cmd:"mceImage"})},a0=function(a){a.addContextToolbar(aO.curry(bx,a),a.getParam("imagetools_toolbar","rotateleft rotateright | flipv fliph | crop editimage imageoptions"))};aE.add("imagetools",function(a){var b=aG(0),c=aG(null);aU(a,b),bN(a),a0(a),aN(a,b,c)})}();